<html>
<head>
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no"/>
	<link rel="stylesheet" href="css/ui-lightness/jquery.ui.all.css">
	<link rel="stylesheet" href="css/ui-lightness/jquery-ui-1.8.6.custom.css">
	<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
	<script src="http://www.google.com/jsapi?key=ABQIAAAAvpzZIJ6aE1PP3WOYtmjZ3BTq7sWfP_v_VCssE0RxAm52ohNf_RRHW8r2VF3Z1ijKTltH6UdcIQaiAw" type="text/javascript"></script>
	<script type="text/javascript">
	var directionDisplay;
	var directionsRenderer;
	var directionsService = new google.maps.DirectionsService();
	var map;

	function drawMap(midpoint) {
		var mid = midpoint.split(",");
		var start = new google.maps.LatLng(mid[0], mid[1]);
		var myOptions = {
			zoom:7,
			mapTypeId: google.maps.MapTypeId.ROADMAP,
			center: start,
			mapTypeControl: false
		}
		map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
	}

	function getRendererOptions(main_route)
	{
		if(main_route)
		{
			var _colour = '#00458E';
			var _strokeWeight = 4;
			var _strokeOpacity = 1.0;
			var _suppressMarkers = false;
		}
		else
		{
			var _colour = '#ED1C24';
			var _strokeWeight = 2;
			var _strokeOpacity = 0.7;
			var _suppressMarkers = false;
		}

		var polylineOptions ={ strokeColor: _colour, strokeWeight: _strokeWeight, strokeOpacity: _strokeOpacity  };

		var rendererOptions = {draggable: false, suppressMarkers: _suppressMarkers, polylineOptions: polylineOptions};

		return rendererOptions;
	}

	function renderDirections(result, rendererOptions, routeToDisplay)
	{

		if(routeToDisplay==0)
		{
			var _colour = '#00458E';
			var _strokeWeight = 4;
			var _strokeOpacity = 1.0;
			var _suppressMarkers = false;
		}
		else
		{
			var _colour = '#ED1C24';
			var _strokeWeight = 4;
			var _strokeOpacity = 0.7;
			var _suppressMarkers = false;
		}

		// if (routeToDisplay == 0) _colour = "#FF0000";


		// create new renderer object
		var directionsRenderer = new google.maps.DirectionsRenderer({
			draggable: false, 
			suppressMarkers: _suppressMarkers, 
			polylineOptions: { 
				strokeColor: _colour, 
				strokeWeight: _strokeWeight, 
				strokeOpacity: _strokeOpacity  
			}
		});
		directionsRenderer.setMap(map);
		directionsRenderer.setDirections(result);
		directionsRenderer.setRouteIndex(routeToDisplay);
	}

	function requestDirections(start, end, routeToDisplay, main_route) {

		var request = {
			origin: start,
			destination: end,
			travelMode: google.maps.DirectionsTravelMode.DRIVING,
			provideRouteAlternatives: main_route
		};


		directionsService.route(request, function(result, status) {
			if (status == google.maps.DirectionsStatus.OK)
			{
				if(main_route)
				{
					var rendererOptions = getRendererOptions(true);
					for (var i = 0; i < result.routes.length; i++)
					{
						renderDirections(result, rendererOptions, i);
					}
				}
				else
				{
					var rendererOptions = getRendererOptions(false);
					renderDirections(result, rendererOptions, routeToDisplay);
				}
			}
		});
	}
	</script>
</head>
<body bgcolor="#FFFFFF" topmargin="2">
	<table>
		<tr>
			<td colspan="3">
				<div id="map_canvas"  style="width: 640px; height: 300px"></div>
			</td>
		</tr>
	</table>
	<script type="text/javascript">
	// users route
	requestDirections('(51.61793418642200,-0.13678550737318)', '(51.15788846699750,-0.16364536053269)', 0, true);
	drawMap("51.3879120942,-0.15028294518");
	</script>
	<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"> 
	</script> 
	<script type="text/javascript"> 
	_uacct = "UA-162157-1";
	urchinTracker();
	</script> 
</body>
</html>
